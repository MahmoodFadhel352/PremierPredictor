{% extends 'base.html' %}
{% load static %}
{% block head %}
<link rel="stylesheet" href="{% static 'css/matches/match-detail.css' %}">
{% endblock %}
{% block content %}

<div class="match-header">
  <h2>{{ object.home_team.name }} vs {{ object.away_team.name }}</h2>
  <div class="match-meta">
    <span class="meta-chip">
      <img src="{% static 'images/teams/whistle.svg' %}" alt="">
      {{ object.kickoff_at|date:"Y-m-d H:i" }}
    </span>
    {% if object.venue %}
    <span class="meta-chip">
      <img src="{% static 'images/teams/stadium.svg' %}" alt="">
      {{ object.venue }}
    </span>
    {% endif %}
    <span class="meta-chip">
      <img src="{% static 'images/teams/scoreboard.svg' %}" alt="">
      {{ object.status }}
    </span>
  </div>
</div>

{% if object.home_score != None and object.away_score != None %}
  <p>Score: {{ object.home_score }} - {{ object.away_score }}</p>
{% endif %}

<p class="byline">
  by {{ object.created_by.username|default:"Unknown" }}
</p>

{% if object.created_by_id == user.id or user.is_staff %}
  <p>
    <a href="{% url 'match-update' object.pk %}" class="btn warn">Edit</a>
    <a href="{% url 'match-delete' object.pk %}" class="btn danger">Delete</a>
  </p>
{% endif %}

<hr />
<h3>Predictions</h3>
<p><a href="{% url 'prediction-create' %}" class="btn submit">+ Add Prediction</a></p>

{% if object.predictions.exists %}
  <table class="prediction-table">
    <thead>
      <tr>
        <th>Who</th>
        <th>Pick</th>
        <th>P(Home)</th>
        <th>P(Draw)</th>
        <th>P(Away)</th>
      </tr>
    </thead>
    <tbody>
      {% for p in object.predictions.all %}
        <tr>
          <td>{{ p.user.username|default:"—" }}</td>
          <td>{{ p.get_pick_display }}</td>
          <td>{{ p.p_home|default:"—" }}</td>
          <td>{{ p.p_draw|default:"—" }}</td>
          <td>{{ p.p_away|default:"—" }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% else %}
  <p>No predictions yet.</p>
{% endif %}
{% endblock %}
